<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ADVICA - Patient Panel</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="icons.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
</head>

<body>
    <div id="auth-container" class="panel-container auth-page">
        <div class="auth-brand">
            <div class="logo">A</div>
            <span class="brand-name">ADVICA</span>
        </div>
        <div class="card auth-card">
            <h1>Patient Portal</h1>
            <p>Access your healthcare dashboard</p>

            <div class="auth-tabs">
                <button class="auth-tab active" onclick="showTab('login')">Sign In</button>
                <button class="auth-tab" onclick="showTab('register')">Register</button>
            </div>

            <form id="login-form" class="auth-form active">
                <div class="input-group">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" name="email" required placeholder="patient@email.com">
                </div>
                <div class="input-group">
                    <label for="login-password">Password</label>
                    <input type="password" id="login-password" name="password" required placeholder="••••••••">
                </div>
                <button type="submit" class="btn btn-primary" style="width:100%">Sign In</button>
            </form>

            <form id="register-form" class="auth-form">
                <div class="input-group">
                    <label for="reg-name">Full Name</label>
                    <input type="text" id="reg-name" required placeholder="Your full name">
                </div>
                <div class="input-group">
                    <label for="reg-email">Email</label>
                    <input type="email" id="reg-email" required placeholder="patient@email.com">
                </div>
                <div class="input-group">
                    <label for="reg-password">Password</label>
                    <input type="password" id="reg-password" required placeholder="Min 6 characters" minlength="6">
                </div>
                <div class="input-group">
                    <label for="reg-age">Age</label>
                    <input type="number" id="reg-age" required placeholder="25" min="1" max="120">
                </div>
                <div class="input-group">
                    <label for="reg-blood">Blood Group</label>
                    <select id="reg-blood" required
                        style="width:100%;padding:0.875rem 1rem;border:2px solid #e2e8f0;border-radius:10px;font-size:1rem;">
                        <option value="">Select Blood Group</option>
                        <option value="A+">A+</option>
                        <option value="A-">A-</option>
                        <option value="B+">B+</option>
                        <option value="B-">B-</option>
                        <option value="AB+">AB+</option>
                        <option value="AB-">AB-</option>
                        <option value="O+">O+</option>
                        <option value="O-">O-</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-accent" style="width:100%">Create Account</button>
            </form>
        </div>
    </div>

    <!-- Main Panel with Sidebar Layout -->
    <div id="main-panel" class="app-layout hidden">
        <!-- Sidebar Navigation -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo-sm">A</div>
                <span class="brand-sm">ADVICA</span>
                <button id="close-sidebar" class="btn-icon mobile-only">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                        <path
                            d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z" />
                    </svg>
                </button>
            </div>

            <nav class="sidebar-nav">
                <button class="nav-item active" data-section="dashboard">
                    <span class="icon-svg"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                            fill="currentColor">
                            <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z" />
                        </svg></span>
                    Dashboard
                </button>
                <button class="nav-item" data-section="profile">
                    <span class="icon-svg"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                            fill="currentColor">
                            <path
                                d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
                        </svg></span>
                    My Profile
                </button>
                <button class="nav-item" data-section="history">
                    <span class="icon-svg"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                            fill="currentColor">
                            <path
                                d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z" />
                        </svg></span>
                    Medical History
                </button>
                <button class="nav-item" data-section="reports">
                    <span class="icon-svg"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                            fill="currentColor">
                            <path
                                d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 16H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z" />
                        </svg></span>
                    My Reports
                </button>
                <hr style="margin: 1rem 0; border:0; border-top:1px solid #e2e8f0; width:100%;">
                <button id="logout-btn" class="nav-item logout">
                    <span class="icon-svg"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                            fill="currentColor">
                            <path
                                d="M17 7l-1.41 1.41L18.17 11H8v2h10.17l-2.58 2.58L17 17l5-5zM4 5h8V3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h8v-2H4V5z" />
                        </svg></span>
                    Logout
                </button>
            </nav>
        </aside>

        <main class="main-content">
            <header class="top-header">
                <button id="menu-toggle" class="btn-icon mobile-only">
                    <span class="icon-svg"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                            fill="currentColor">
                            <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" />
                        </svg></span>
                </button>
                <div class="user-welcome">
                    <span class="avatar sm">P</span>
                    <div>
                        <h3 id="patient-name">Loading...</h3>
                        <span id="patient-id" class="badge">ID: --</span>
                    </div>
                </div>
            </header>

            <!-- Dashboard View -->
            <section id="dashboard-view" class="view-section active">
                <div class="dashboard-grid">
                    <div class="card welcome-card">
                        <h2>Welcome back!</h2>
                        <p>Track your health and consult with top doctors.</p>
                        <button id="quick-consult-btn" class="btn btn-primary mt-4">Consult Doctor Now</button>
                    </div>

                    <div class="card info-summary">
                        <h3>Vitals Overview</h3>
                        <div class="info-grid">
                            <div class="info-item"><label>Age</label><span id="dash-age">--</span></div>
                            <div class="info-item"><label>Blood</label><span id="dash-blood">--</span></div>
                            <div class="info-item"><label>Weight</label><span id="dash-weight">--</span></div>
                        </div>
                    </div>
                </div>

                <div class="recent-section mt-6">
                    <h3>Recent Consultations</h3>
                    <div id="patient-history-list" class="history-list-compact">
                        <!-- Loaded via JS -->
                    </div>
                </div>

                <!-- Recent Reports On Dashboard -->
                <div class="recent-section mt-6">
                    <h3>Recent Reports</h3>
                    <div id="dashboard-reports-list">
                        <div class="card empty-state-sm">
                            <p style="color:var(--text-muted);font-size:0.9rem;">No recent reports found.</p>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Profile View -->
            <section id="profile-view" class="view-section hidden">
                <div class="card profile-card">
                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:1.5rem;">
                        <h2>Edit Profile</h2>
                    </div>
                    <form id="profile-form">
                        <div class="form-grid">
                            <div class="input-group">
                                <label>Full Name</label>
                                <input type="text" id="p-name-input" required>
                            </div>
                            <div class="input-group">
                                <label>Age</label>
                                <input type="number" id="p-age-input" required>
                            </div>
                            <div class="input-group">
                                <label>Gender</label>
                                <select id="p-gender-input">
                                    <option value="Male">Male</option>
                                    <option value="Female">Female</option>
                                    <option value="Other">Other</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label>Blood Group</label>
                                <select id="p-blood-input">
                                    <option value="A+">A+</option>
                                    <option value="A-">A-</option>
                                    <option value="B+">B+</option>
                                    <option value="B-">B-</option>
                                    <option value="O+">O+</option>
                                    <option value="O-">O-</option>
                                    <option value="AB+">AB+</option>
                                    <option value="AB-">AB-</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label>Height (cm)</label>
                                <input type="number" id="p-height-input">
                            </div>
                            <div class="input-group">
                                <label>Weight (kg)</label>
                                <input type="number" id="p-weight-input">
                            </div>
                            <div class="input-group full-width">
                                <label>Address</label>
                                <textarea id="p-address-input" rows="2"></textarea>
                            </div>
                            <div class="input-group full-width">
                                <label>Medical History / Allergies</label>
                                <textarea id="p-medical-input" rows="3"
                                    placeholder="Diabetes, Hypertension, Penicillin allergy..."></textarea>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary" id="save-profile-btn"
                            style="margin-top:1rem;">Save Changes</button>
                    </form>
                </div>
            </section>

            <!-- Medical History View -->
            <section id="history-view" class="view-section hidden">
                <h2>Medical History</h2>
                <div class="card table-card mt-4">
                    <div id="full-history-list">
                        <!-- Full history table/list -->
                    </div>
                </div>
            </section>

            <!-- Reports View -->
            <section id="reports-view" class="view-section hidden">
                <h2>My Reports</h2>
                <div class="card empty-state">
                    <span class="icon-svg big"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                            fill="currentColor">
                            <path
                                d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zM6 20V4h7v5h5v11H6z" />
                        </svg></span>
                    <p>No reports uploaded yet.</p>
                    <button class="btn btn-outline mt-4">Upload Report</button>
                </div>
            </section>

            <!-- Live Consultation View (Full Screen Overlay effect) -->
            <div id="consultation-area" class="consultation-overlay hidden">
                <header class="consult-header">
                    <div class="doctor-badge">
                        <span class="avatar sm doctor">D</span>
                        <div class="col">
                            <h3 id="doctor-name-display">Connecting...</h3>
                            <span class="status-dot">Live</span>
                        </div>
                    </div>
                </header>

                <div class="consult-grid">
                    <div class="video-feed card">
                        <div class="placeholder-video">
                            <span class="icon-svg big"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                                    fill="currentColor">
                                    <path
                                        d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z" />
                                </svg></span>
                            <p>Video Call Ready</p>
                        </div>
                    </div>
                    <div class="chat-container card">
                        <div class="chat-header">Chat with Doctor</div>
                        <div id="chat-messages" class="chat-messages"></div>
                        <div class="chat-input">
                            <input type="text" id="chat-input" placeholder="Type a message...">
                            <button id="send-btn" class="btn btn-primary">Send</button>
                        </div>
                    </div>
                </div>

                <div class="emergency-action mt-4" style="max-width: 800px; margin: 1rem auto;">
                    <button onclick="flagEmergency()" class="btn btn-danger full-width">
                        ⚠️ FLAG EMERGENCY
                    </button>
                </div>

                <div class="mt-4" style="max-width: 800px; margin: 1rem auto;">
                    <div id="doctor-disconnect-notice" class="disconnect-notice hidden">
                        <span><span class="icon-svg" style="color:var(--warning);"><svg
                                    xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                                    <path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z" />
                                </svg></span> Doctor disconnected!</span>
                        <button id="find-new-doctor-btn" class="btn btn-primary btn-sm">Find New Doctor</button>
                    </div>
                </div>
            </div>

        </main>
    </div>

    <!-- Consultation Request Modal -->
    <div id="consult-modal" class="modal hidden">
        <div class="modal-content">
            <h2>Start Consultation</h2>
            <p>Describe your issue briefly to help the doctor.</p>
            <textarea id="consult-symptoms" placeholder="Headache, fever for 2 days..."></textarea>
            <div class="modal-actions">
                <button id="cancel-consult" class="btn btn-outline">Cancel</button>
                <button id="confirm-consult" class="btn btn-primary">Find Doctor</button>
            </div>
        </div>
    </div>

    <div id="prescription-modal" class="modal hidden">
        <div class="modal-content">
            <h2><span class="icon-svg icon-lg"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"
                        fill="currentColor">
                        <path
                            d="M19 3h-4.18C14.4 1.84 13.3 1 12 1c-1.3 0-2.4.84-2.82 2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 0c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm2 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z" />
                    </svg></span> Prescription</h2>
            <div id="prescription-details">
                <p><strong>Doctor:</strong> <span id="rx-doctor">--</span></p>
                <p><strong>Date:</strong> <span id="rx-date">--</span></p>
            </div>
            <div id="prescription-content" class="prescription-box">
                <!-- Prescription text here -->
            </div>
            <div class="modal-actions">
                <button id="close-prescription-modal" class="btn btn-primary" style="width:100%;">Close</button>
            </div>
        </div>
    </div>

    <script>
        // Tab switching logic
        function showTab(tab) {
            document.querySelectorAll('.auth-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.auth-form').forEach(f => f.classList.remove('active'));

            if (tab === 'login') {
                document.querySelector('.auth-tab:first-child').classList.add('active');
                document.getElementById('login-form').classList.add('active');
            } else {
                document.querySelector('.auth-tab:last-child').classList.add('active');
                document.getElementById('register-form').classList.add('active');
            }
        }
    </script>
    <script type="module" src="./scripts/patient.js"></script>
</body>

</html>